<div class="padding-md">
	<div class="smart-widget">
		<div class="smart-widget-inner">
			<div class="smart-widget-body">
				<table class="table table-striped table-bordered m-top-sm" id="dataTable">
					<thead>
						<tr>
							<th>编号</th>
							<th>登录帐号</th>
							<th>登录时间</th>
							<th>登录IP</th>
						</tr>
					</thead>
					<tbody>
						<foreach name="list" item="v">

						<tr id="data-{$v['id']}">
							<td>{$v.id}</td>
							<td>
								{$v.user_name}
							</td>
							<td>{$v.login_time}</td>
							<td>{$v.login_ip}</td>
						</tr>
						</foreach>
					</tbody>
				</table>
				<div class="content text-right">
					<ul class="pagination">
					{$page}
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	//搜索功能
	$("#search").click(function(){
		var url = $(this).attr('url');
        var query  = $('#search-form').find('.input-sm').serialize();
        if(!$('input[name="keyword"]').val()){
        	DMS.alert("请输入会员帐号");
        	return;
        }
        if( url.indexOf('?')>0 ){
            url += '&' + query;
        }else{
            url += '?' + query;
        }
		window.location.href = url;
	});
	$(".check-all").click(function(){
		$(".ids").prop("checked", this.checked);
	});
	$(".ids").click(function(){
		var option = $(".ids");
		option.each(function(i){
			if(!this.checked){
				$(".check-all").prop("checked", false);
				return false;
			}else{
				$(".check-all").prop("checked", true);
			}
		});
	});
	function manager(type){
		var ids='';
		$("input[name='ids[]']:checked").each(function(i, n){
			ids += $(n).val() + ',';
		});
		ids = ids.substring(0,ids.length-1);

		if(ids=='') {
			DMS.alert("请先选择会员")
			return false;
		}else{
			var url = "__CONTROLLER__/membersDelete";
			DMS.dialog("确定要执行当前操作吗?",function(){
				DMS.ajaxPost(url,{ids:ids},function(ret){
					if(ret.status==1){
						DMS.success(ret.info,0,function(){
							window.location.href = window.location.href;
						});
					}else{
						DMS.error(ret.info,0);
					}
				})
			});
		}
	}
	function memberAdd(){
		DMS.ajaxShow("编辑用户","__CONTROLLER__/memberAdd");
	}
	function memberEdit(id){
		DMS.ajaxShow("编辑用户","__CONTROLLER__/memberEdit/id/"+id);
	}
	function reSearch(){
		window.location.href = "__ACTION__";
	}
	function showInfo(id){
		DMS.loadUrl("用户详情","__CONTROLLER__/memberInfo/id/"+id);
	}
	function memberDelete(id){
		DMS.dialog("确定要删除吗?",function(){
			DMS.ajaxPost("__CONTROLLER__/memberDelete",{id:id},function(ret){
				if(ret.status==1){
                	DMS.success(ret.info,0,function(){
                		$("#data-"+id).remove();
					});
                }else{
                	DMS.error(ret.info,0);
                }
			})
		});
	}
</script>
